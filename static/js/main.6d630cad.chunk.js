(this["webpackJsonpodinbook-frontend"]=this["webpackJsonpodinbook-frontend"]||[]).push([[0],{34:function(e,t,n){},42:function(e,t,n){},62:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n(35),a=n.n(c),r=n(8),i=(n(42),n(2)),o=n(4),l=n(3),u=n.n(l),d=(n(62),n(0)),j=function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(s.useEffect)((function(){u.a.defaults.baseURL="https://damp-anchorage-97572.herokuapp.com/"}),[]),Object(d.jsx)("div",{className:"app",children:n?Object(d.jsxs)("div",{children:[Object(d.jsx)(v,{logout:function(){return c(!1)}}),Object(d.jsx)("div",{className:"container",children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)(o.a,{path:["/","/posts"],exact:!0,children:Object(d.jsx)(_,{})}),Object(d.jsx)(o.a,{path:"/posts/:postId",children:Object(d.jsx)(I,{})}),Object(d.jsx)(o.a,{path:"/users",exact:!0,children:Object(d.jsx)(L,{})}),Object(d.jsx)(o.a,{path:"/users/:userId",children:Object(d.jsx)(q,{})})]})})]}):Object(d.jsx)(h,{setHeaders:function(e){u.a.defaults.headers.common.Authorization="Bearer ".concat(e),c(!0)}})})},b=(n(69),n(14)),m=n(18),p=n(24),O=function(e){var t=e.closePopup,n=Object(s.useState)([]),c=Object(i.a)(n,2),a=c[0],r=c[1],o=Object(s.useState)(null),l=Object(i.a)(o,2),j=l[0],O=l[1],h=Object(s.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),f=Object(i.a)(h,2),v=f[0],x=f[1],g=function(e){x((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},e.target.name,"image"===e.target.name?e.target.files[0]:e.target.value))}))};return Object(d.jsxs)("form",{className:"signup-form",onSubmit:function(e){e.preventDefault();var n=new FormData;for(var s in v)n.append([s],v[s]);u.a.post("/signup",n,{}).then((function(e){var n;O(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message),null!==e&&void 0!==e&&e.errors?r(Object(b.a)(null===e||void 0===e?void 0:e.errors)):(r([]),setTimeout((function(){return t()}),1e3))})).catch((function(e){console.log(e.response)}))},encType:"multipart/form-data",children:[Object(d.jsx)("h2",{className:"form-title",children:"Signup"}),Object(d.jsx)("img",{className:"exit-btn",src:"https://static.xx.fbcdn.net/rsrc.php/v3/yX/r/TdCEremeWv5.png",alt:"",onClick:t}),a.map((function(e,t){return Object(d.jsxs)("div",{className:"error",children:["- ",e.msg]},t)})),j&&Object(d.jsx)("div",{className:"message",children:j}),Object(d.jsx)("div",{className:"line"}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"text",name:"firstName",value:v.firstName,onChange:g,placeholder:"First Name"})}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"text",name:"lastName",value:v.lastName,onChange:g,placeholder:"Last Name"})}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"email",name:"email",value:v.email,onChange:g,placeholder:"Email"})}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"password",name:"password",value:v.password,onChange:g,placeholder:"Password"})}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"password",name:"confirmPassword",value:v.confirmPassword,onChange:g,placeholder:"Confirm Password"})}),Object(d.jsxs)("label",{children:["Profile Picture",Object(d.jsx)("input",{type:"file",name:"image",onChange:g})]}),Object(d.jsx)("button",{type:"submit",className:"signup-btn",children:"Sign Up"})]})},h=function(e){var t=e.setHeaders,n=Object(s.useState)(""),c=Object(i.a)(n,2),a=c[0],r=c[1],o=Object(s.useState)(""),l=Object(i.a)(o,2),j=l[0],b=l[1],m=Object(s.useState)(null),p=Object(i.a)(m,2),h=p[0],f=p[1],v=Object(s.useState)(!1),x=Object(i.a)(v,2),g=x[0],N=x[1];return Object(d.jsxs)("div",{className:"login",children:[Object(d.jsx)("header",{children:"Welcome Banter!"}),g?Object(d.jsx)(O,{closePopup:function(){return N(!1)}}):Object(d.jsxs)("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),u.a.post("/login",{email:a,password:j}).then((function(e){var n,s;f(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message);var c=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.token;c&&t(c)})).catch((function(e){return console.log(e.response||e)}))},children:[h&&Object(d.jsxs)("div",{className:"error",children:["- ",h]}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"email",name:"email",value:a,onChange:function(e){return r(e.target.value)},placeholder:"Email"})}),Object(d.jsx)("label",{children:Object(d.jsx)("input",{type:"password",name:"password",value:j,onChange:function(e){return b(e.target.value)},placeholder:"Password"})}),Object(d.jsx)("button",{className:"submit-btn",children:"Log In"}),Object(d.jsx)("div",{className:"line"}),Object(d.jsx)("button",{type:"button",className:"signup-btn",onClick:function(){return N(!0)},children:"Sign Up"})]})]})},f=(n(70),function(e){return"data:image/jpeg;base64,".concat(e)}),v=function(e){var t=e.logout,n=Object(s.useState)(!0),c=Object(i.a)(n,2),a=c[0],o=c[1];return Object(s.useEffect)((function(){u.a.get("/users/me").then((function(e){var t=e.data.user;null!==t&&void 0!==t&&t.image&&(t.image=f(t.image.image.data)),o(t)})).catch((function(e){var t,n;return console.log((null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||e.request)}))}),[]),Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)(r.b,{to:"/",children:Object(d.jsx)("header",{children:Object(d.jsx)("h1",{className:"logo",children:"Banter"})})}),Object(d.jsxs)("nav",{className:"navbar",children:[Object(d.jsx)(r.b,{className:"link",to:"/users",children:"Users"}),Object(d.jsx)(r.b,{className:"link",to:"/users/".concat(a._id),children:(null===a||void 0===a?void 0:a.image)&&Object(d.jsxs)("div",{className:"profilePic",children:[Object(d.jsx)("div",{className:"usersName",children:a.fullName}),Object(d.jsx)("img",{src:(null===a||void 0===a?void 0:a.image)||"/empty_profile.png",alt:"profile pic",width:"50",height:"50"})]})}),Object(d.jsx)("div",{className:"link",onClick:t,children:"Logout"})]})]})},x=n(12),g=n(11),N=n.n(g),k=n(3).default,S=n(19).useState,w=function(e){var t=e.refresh,n=S(""),s=Object(i.a)(n,2),c=s[0],a=s[1],r=S(null),o=Object(i.a)(r,2),l=o[0],u=o[1],j=S(null),b=Object(i.a)(j,2),m=b[0],p=b[1],O=function(){var e=Object(x.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,k.post("/posts/",{content:c}).then((function(e){return p(e.data.msg)})).catch((function(e){return u(e.response.data.err)}));case 3:a(""),t();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("form",{className:"postForm",onSubmit:O,children:[Object(d.jsx)("label",{children:Object(d.jsx)("textarea",{onChange:function(e){return a(e.target.value)},value:c,rows:2,maxLength:500,placeholder:"Whats on your mind?"})}),Object(d.jsx)("button",{className:"submit-btn",children:"Submit"}),m&&Object(d.jsx)("div",{className:"message",children:m}),l&&Object(d.jsx)("div",{className:"error",children:l})]})},y=function(e){var t=e.postId,n=e.refresh,c=Object(s.useState)(""),a=Object(i.a)(c,2),r=a[0],o=a[1],l=Object(s.useState)([]),j=Object(i.a)(l,2),m=j[0],p=j[1],O=function(){var e=Object(x.a)(N.a.mark((function e(s){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,u.a.post("/posts/".concat(t),{content:r}).then((function(e){var t;p(null!==(t=e)&&void 0!==t&&t.errors?t.errors.map((function(e){return e.msg})):null!==t&&void 0!==t&&t.err?[t.err]:[])})).catch((function(e){return p([].concat(Object(b.a)(m),[e.response.data.err]))}));case 3:o(""),n();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("form",{className:"comment-box",onSubmit:O,children:[Object(d.jsxs)("label",{children:["Reply:",Object(d.jsx)("textarea",{onChange:function(e){return o(e.target.value)},value:r,rows:1,cols:40,maxLength:300})]}),Object(d.jsx)("button",{className:"submit-btn",children:"Submit"}),m&&m.map((function(e){return Object(d.jsx)("div",{className:"error",children:e})}))]})},C=function(e){var t=e.post;return Object(d.jsx)("div",{className:"expanded-likes",children:null===t||void 0===t?void 0:t.likes.map((function(e,t){return Object(d.jsx)("li",{children:e.fullName},t)}))})},P=function(e){var t,n,c,a=e.refresh,o=e.post,l=Object(s.useState)(!1),j=Object(i.a)(l,2),m=j[0],p=j[1],O=Object(s.useState)(!1),h=Object(i.a)(O,2),v=h[0],g=h[1],k=function(){var e=Object(x.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,u.a.post("/posts/".concat(o._id,"/like")).then((function(e){return console.log(e.data.msg)}));case 4:a(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"post",children:[Object(d.jsxs)("div",{className:"post-info",children:[Object(d.jsx)(r.b,{to:"/users/".concat(o.author._id),children:Object(d.jsxs)("div",{className:"profilePic",children:[Object(d.jsx)("div",{className:"author",children:o.author.fullName}),(null===(t=o.author)||void 0===t?void 0:t.image)&&Object(d.jsx)("img",{src:f(o.author.image)||"https://fertilitynetworkuk.org/wp-content/uploads/2017/01/Facebook-no-profile-picture-icon-620x389.jpg",alt:"profile pic",width:"50"})]})}),Object(d.jsx)("p",{className:"content",children:o.content}),Object(d.jsxs)("div",{className:"stats-bar",children:[Object(d.jsxs)("span",{className:"number-likes",onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},children:[(null===o||void 0===o||null===(n=o.likes)||void 0===n?void 0:n.length)||"0"," Likes"]}),m&&Object(d.jsx)(C,{post:o})," \xb7 ",Object(d.jsxs)("span",{children:[null===o||void 0===o||null===(c=o.comments)||void 0===c?void 0:c.length," Comments"]})]}),Object(d.jsxs)("div",{className:"actions-bar",children:[Object(d.jsx)("button",{className:"like-button ".concat(o.liked&&"active"),onClick:k,children:o.liked?"Unlike":"Like"}),Object(d.jsx)("button",{className:"comment-button",onClick:function(){return g(!v)},children:"Comment"})]})]}),Object(d.jsxs)("div",{className:"comments",children:[o.comments&&Object(b.a)(o.comments).sort((function(e,t){return e.dateAdded>t.dateAdded?1:-1})).map((function(e){var t;return Object(d.jsxs)("div",{className:"comment",children:[Object(d.jsx)("div",{className:"author",children:null===e||void 0===e||null===(t=e.author)||void 0===t?void 0:t.fullName}),Object(d.jsx)("p",{className:"content",children:e.content})]},e._id)})),v&&Object(d.jsx)(y,{refresh:a,postId:o._id})]})]})},_=(n(34),function(){var e=Object(s.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(null),r=Object(i.a)(a,2),o=r[0],l=r[1],j=Object(s.useCallback)((function(){u.a.get("/posts").then((function(e){c(e.data.posts),l(null===e||void 0===e?void 0:e.data.err)})).catch((function(e){return l(e)}))}),[]);return Object(s.useEffect)((function(){j()}),[j]),Object(d.jsxs)("div",{className:"posts-container",children:[o&&Object(d.jsx)("div",{className:"error",children:o}),Object(d.jsx)(w,{refresh:j}),n.map((function(e){return Object(s.createElement)(P,{post:e,refresh:j,key:e._id})}))]})}),E=n(19),I=function(){var e=Object(E.useState)(),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(E.useState)(null),r=Object(i.a)(a,2),l=r[0],j=r[1],b=Object(o.f)().postId,m=function(){u.a.get("/posts/".concat(b)).then((function(e){c(e.post),j(null===e||void 0===e?void 0:e.err)})).catch((function(e){return j(e)}))};return Object(s.useEffect)((function(){m()})),Object(d.jsxs)("div",{className:"post-container",children:[l&&Object(d.jsx)("div",{className:"error",children:l}),n.map((function(e){return Object(d.jsx)(P,{post:e,refresh:m})}))]})},F=(n(72),function(e){var t=e.user,n=Object(s.useState)(null),c=Object(i.a)(n,2),a=c[0],o=c[1],l=Object(s.useState)(null),j=Object(i.a)(l,2),b=j[0],m=j[1],p=function(e){u.a.put("/users/requests/".concat(t._id),{requestResponse:e}).then((function(e){o(null===e||void 0===e?void 0:e.data.msg)})).catch((function(e){m(e.response.data.msg),console.log(e.response)}))};return Object(d.jsxs)("div",{className:"user-card",children:[a&&Object(d.jsx)("div",{className:"message",children:a}),b&&Object(d.jsx)("div",{className:"error",children:b}),Object(d.jsx)("div",{className:"profilePic",children:Object(d.jsx)("img",{src:(null===t||void 0===t?void 0:t.image)||"/empty_profile.png",alt:"profile pic",height:50,width:50})}),Object(d.jsxs)("div",{className:"profileInfo",children:[Object(d.jsx)(r.b,{to:"/users/".concat(t._id),children:Object(d.jsx)("div",{className:"name",children:null===t||void 0===t?void 0:t.fullName})}),Object(d.jsx)("div",{className:"status",children:function(e){switch(e){case"denied":case void 0:return Object(d.jsx)("button",{type:"button",className:"addFriend-status",onClick:function(){return e=t._id,void u.a.post("/users/requests/".concat(e)).then((function(e){var t;o(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)})).catch((function(e){m(e.response.data.msg),console.log(e.response)}));var e},children:"Add Friend"});case"received":return Object(d.jsxs)("div",{className:"respondFriend-status",children:[Object(d.jsx)("button",{type:"button",className:"confirmFriend-status",onClick:function(){return p("accepted")},children:"Confirm"}),Object(d.jsx)("button",{type:"button",className:"rejectFriend-status",onClick:function(){return p("denied")},children:"Reject"})]});case"accepted":return Object(d.jsx)("button",{type:"button",className:"friends-status",children:"Friends"});case"pending":return Object(d.jsx)("button",{type:"button",className:"pending-status",children:"Pending.."});default:return Object(d.jsx)("button",{type:"button",className:"no-status"})}}(t.friendsStatus)}),Object(d.jsx)("br",{})]})]})}),L=function(){var e=Object(s.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(null),r=Object(i.a)(a,2),o=r[0],l=r[1],j=Object(s.useCallback)((function(){u.a.get("/users").then((function(e){e.data.users.forEach((function(e){null!==e&&void 0!==e&&e.image&&(e.image=f(e.image.image.data))})),c(e.data.users),l(null===e||void 0===e?void 0:e.data.err)})).catch((function(e){var t,n;return l((null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||(null===e||void 0===e?void 0:e.response))}))}),[]);return Object(s.useEffect)((function(){j()}),[j]),Object(d.jsxs)("div",{className:"users-container",children:[o&&Object(d.jsx)("div",{className:"error",children:o}),n&&n.map((function(e){return Object(s.createElement)(F,{user:e,refresh:j,key:e._id})}))]})},D=n(3).default,R=n(1).useState,U=function(e){var t=e.exit,n=e.refresh,s=e.priorImage,c=R(null),a=Object(i.a)(c,2),r=a[0],o=a[1],l=R(!1),u=Object(i.a)(l,2),j=u[0],b=u[1],m=R(""),p=Object(i.a)(m,2),O=p[0],h=p[1],f=R(null),v=Object(i.a)(f,2),x=v[0],g=v[1];return Object(d.jsxs)("form",{className:"updateImage",onSubmit:function(e){e.preventDefault();var s=new FormData;r&&s.append("image",r),j&&s.append("remove-image",!0),D.put("/users/update_image",s,{}).then((function(e){var s;h(null===(s=e.data)||void 0===s?void 0:s.msg),t(),n()})).catch((function(e){var t,n;console.log(e.response),g((null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.err)||e.response)}))},encType:"multipart/form-data",children:[O&&Object(d.jsx)("div",{className:"message",children:O}),x&&Object(d.jsx)("div",{className:"error",children:x}),Object(d.jsxs)("label",{children:["Profile Picture",Object(d.jsx)("input",{type:"file",name:"image",onChange:function(e){return o(e.target.files[0])}})]}),s&&Object(d.jsx)("button",{type:"submit",onClick:function(){return b(!0)},children:"Remove Current Image"}),Object(d.jsx)("button",{type:"submit",children:"Submit"})]})},q=function(){var e=Object(o.f)().userId,t=Object(s.useState)(null),n=Object(i.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(null),l=Object(i.a)(r,2),j=l[0],b=l[1],m=Object(s.useState)(!1),p=Object(i.a)(m,2),O=p[0],h=p[1],v=Object(s.useState)(!1),g=Object(i.a)(v,2),k=g[0],S=g[1],w=Object(s.useCallback)(Object(x.a)(N.a.mark((function t(){var n,s,c,r;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.get("/users/".concat(e));case 3:return null!==(n=t.sent.data.user)&&void 0!==n&&n.image&&(n.image=f(n.image.image.data)),t.next=7,u.a.get("/users/me");case 7:s=t.sent.data.user,h(s._id===n._id),a(n),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),b((null===(c=t.t0.response)||void 0===c||null===(r=c.data)||void 0===r?void 0:r.err)||t.t0.response);case 15:case"end":return t.stop()}}),t,null,[[0,12]])}))),[e]);return Object(s.useEffect)((function(){return w()}),[w]),Object(d.jsxs)("div",{className:"userPage",children:[O&&k&&Object(d.jsx)(U,{exit:function(){return S(!1)},refresh:w,priorImage:!!c.image}),j&&Object(d.jsx)("div",{className:"error",children:j}),c&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"profilePic",onClick:function(){return S(!0)},children:Object(d.jsx)("img",{src:(null===c||void 0===c?void 0:c.image)||"/empty_profile.png",alt:"profile pic",width:"80"})}),Object(d.jsx)("div",{className:"fullName",children:c.fullName}),Object(d.jsx)("div",{className:"posts-container",children:c.posts.length>0?c.posts.map((function(e){return Object(s.createElement)(P,{post:e,refresh:w,key:e._id})})):Object(d.jsx)("p",{children:"No posts to show"})})]})]})};a.a.render(Object(d.jsx)(r.a,{children:Object(d.jsx)(j,{})}),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.6d630cad.chunk.js.map